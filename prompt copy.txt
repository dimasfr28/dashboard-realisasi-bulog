Buatkan saya Tabel lagi diatas dari line chart:
saat ini saya ingin mengsorting yang ditampilkan sekarang, sorting ini berdasarkan kanwil, ada 2 kanwil
Kanwil Sentra Produksi:
08001 - KANTOR WILAYAH LAMPUNG
21001 - KANTOR WILAYAH SULSEL SULBAR
20001 - KANTOR WILAYAH SULTRA
12001 - KANTOR WILAYAH DI YOGYAKARTA
09001 - KANTOR WILAYAH DKI JAKARTA BANTEN
23001 - KANTOR WILAYAH N.T.B
13001 - KANTOR WILAYAH JATIM
10001 - KANTOR WILAYAH JABAR
01001 - KANTOR WILAYAH ACEH
06001 - KANTOR WILAYAH SUMSEL
11001 - KANTOR WILAYAH JATENG

Kanwil Lainnya:
15001 - KANTOR WILAYAH KALTIM KALTARA
25001 - KANTOR WILAYAH MALUKU MALUT
26001 - KANTOR WILAYAH PAPUA PABAR
02001 - KANTOR WILAYAH SUMUT
04001 - KANTOR WILAYAH SUMBAR
17001 - KANTOR WILAYAH KALTENG
16001 - KANTOR WILAYAH KALSEL
14001 - KANTOR WILAYAH KALBAR
18001 - KANTOR WILAYAH SULUT GORONTALO
05001 - KANTOR WILAYAH JAMBI
19001 - KANTOR WILAYAH SULTENG
24001 - KANTOR WILAYAH N.T.T
03001 - KANTOR WILAYAH RIAU DAN KEPRI
22001 - KANTOR WILAYAH BALI
07001 - KANTOR WILAYAH BENGKULU

yang ditampilkan tabel hanya itu, lalu struktur tabelnya sebagai berikut:
<table border="1" cellspacing="0" cellpadding="4" style="border-collapse: collapse; width:100%; font-size:14px;">
    <thead>
        <tr style="background:#f2f2f2; font-weight:bold; text-align:center;">
            <th rowspan="2">No.</th>
            <th rowspan="2">Kanwil</th>
            <th rowspan="2">Target Setara Beras</th>
            <th colspan="5">Realisasi S. d. [Tanggal select filter]</th>
        </tr>
        <tr style="background:#f2f2f2; font-weight:bold; text-align:center;">
            <th>Beras (a)</th>
            <th>GKG (b)</th>
            <th>GKP (c)</th>
            <th>Setara Beras (d)</th>
            <th>Capaian (%)</th>
        </tr>
    </thead>

    <tbody>

        <!-- BAGIAN A -->
        <tr style="background:#ffe599; font-weight:bold;">
            <td colspan="8">a) Kanwil Sentra Produksi</td>
        </tr>

        <tr>
            <td>[No (dimulai dari 1)]</td>
            <td>[Kanwil Sentra Produksi]</td>
            <td>[df_target[Target Setara Beras] yang sama dengan nama kanwil]</td>
            <td>[Ambil value total BERAS (BERAS MEDIUM+BERAS PREMIUM dari df["Komoditi"])]</td>
            <td>[Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKG lalu total sesuai kanwil]</td>
            <td>[Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKP lalu total sesuai kanwil]</td>
            <td>[ambil value yang sebaris, untuk menadapatkan setara beras maka lakukan fungsi berikut d=a+0.635b+0.53375c]</td>
            <td>[realisisasi = persentase target setara beras yang terealisasikan (d)]</td>
        </tr>
              <!-- SUBTOTAL A -->
        <tr style="background:#ffe599; font-weight:bold;">
            <td colspan="2">Total Kanwil Sentra Produksi</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
        </tr>

        <!-- BAGIAN B -->
        <tr style="background:#c9daf8; font-weight:bold;">
            <td colspan="8">b) Kanwil Lainnya</td>
        </tr>

        <tr>
            <td>[No (dimulai dari 1)]</td>
            <td>[Kanwil lainnya]</td>
            <td>[df_target[Target Setara Beras] yang sama dengan nama kanwil]</td>
            <td>[Ambil value total BERAS (BERAS MEDIUM+BERAS PREMIUM dari df["Komoditi"])]</td>
            <td>[Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKG lalu total sesuai kanwil]</td>
            <td>[Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKP lalu total sesuai kanwil]</td>
            <td>[ambil value yang sebaris, untuk menadapatkan setara beras maka lakukan fungsi berikut d=a+0.635b+0.53375c]</td>
            <td>[realisisasi = persentase target setara beras yang terealisasikan (d)]</td>
        </tr>

        <!-- SUBTOTAL B -->
        <tr style="background:#c9daf8; font-weight:bold;">
            <td colspan="2">Total Kanwil Lainnya</td>
             <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
        </tr>

        <!-- TOTAL SELINDO -->
        <tr style="background:#b6d7a8; font-weight:bold;">
            <td colspan="2">TOTAL SE-INDO</td>
             <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
            <td>[total value]</td>
        </tr>

    </tbody>
</table>

saya ingin ada export excel yang hasilnya harus sama persis dengan style tabel di tampilan html


Selain itu, ada revisi line chart:
Hapus filter komoditi, lalu buatkan saya filter kanwil. jadi datanya hanya berdasarkan kanwil.
buat linenya ada 3:
BERAS = BERAS PREMIUM+BERAS MEDIUM
GKP = Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKP
GKB = Ambil "Komoditi" Gabah yang "spesifikasi" nya adalah GKB
